#lang racket/base

(require rackunit
         "simtest.rkt"
         "../src/array.rkt")

(test-case "*** NOT-16 ***"
  (check-table?
    (simulate not-16 '(16) '(16))
    '(((#b0000000000000000) (#b1111111111111111))
      ((#b1111111111111111) (#b0000000000000000))
      ((#b1010101010101010) (#b0101010101010101))
      ((#b0011110011000011) (#b1100001100111100))
      ((#b0001001000110100) (#b1110110111001011)))))

(test-case "*** AND-16 ***"
  (check-table?
    (simulate and-16 '(16 16) '(16))
    '(((#b0000000000000000 #b0000000000000000) (#b0000000000000000))
      ((#b0000000000000000 #b1111111111111111) (#b0000000000000000))
      ((#b1111111111111111 #b1111111111111111) (#b1111111111111111))
      ((#b1010101010101010 #b0101010101010101) (#b0000000000000000))
      ((#b0011110011000011 #b0000111111110000) (#b0000110011000000))
      ((#b0001001000110100 #b1001100001110110) (#b0001000000110100)))))

(test-case "*** NAND-16 ***"
  (check-table?
    (simulate nand-16 '(16 16) '(16))
    '(((#b0000000000000000 #b0000000000000000) (#b1111111111111111))
      ((#b0000000000000000 #b1111111111111111) (#b1111111111111111))
      ((#b1111111111111111 #b1111111111111111) (#b0000000000000000))
      ((#b1010101010101010 #b0101010101010101) (#b1111111111111111))
      ((#b0011110011000011 #b0000111111110000) (#b1111001100111111))
      ((#b0001001000110100 #b1001100001110110) (#b1110111111001011)))))

(test-case "*** OR-16 ***"
  (check-table?
    (simulate or-16 '(16 16) '(16))
    '(((#b0000000000000000 #b0000000000000000) (#b0000000000000000))
      ((#b0000000000000000 #b1111111111111111) (#b1111111111111111))
      ((#b1111111111111111 #b1111111111111111) (#b1111111111111111))
      ((#b1010101010101010 #b0101010101010101) (#b1111111111111111))
      ((#b0011110011000011 #b0000111111110000) (#b0011111111110011))
      ((#b0001001000110100 #b1001100001110110) (#b1001101001110110)))))

(test-case "*** NOR-16 ***"
  (check-table?
    (simulate nor-16 '(16 16) '(16))
    '(((#b0000000000000000 #b0000000000000000) (#b1111111111111111))
      ((#b0000000000000000 #b1111111111111111) (#b0000000000000000))
      ((#b1111111111111111 #b1111111111111111) (#b0000000000000000))
      ((#b1010101010101010 #b0101010101010101) (#b0000000000000000))
      ((#b0011110011000011 #b0000111111110000) (#b1100000000001100))
      ((#b0001001000110100 #b1001100001110110) (#b0110010110001001)))))

(test-case "*** XOR-16 ***"
  (check-table?
    (simulate xor-16 '(16 16) '(16))
    '(((#b0000000000000000 #b0000000000000000) (#b0000000000000000))
      ((#b0000000000000000 #b1111111111111111) (#b1111111111111111))
      ((#b1111111111111111 #b1111111111111111) (#b0000000000000000))
      ((#b1010101010101010 #b0101010101010101) (#b1111111111111111))
      ((#b0011110011000011 #b0000111111110000) (#b0011001100110011))
      ((#b0001001000110100 #b1001100001110110) (#b1000101001000010)))))

(test-case "*** XNOR-16 ***"
  (check-table?
    (simulate xnor-16 '(16 16) '(16))
    '(((#b0000000000000000 #b0000000000000000) (#b1111111111111111))
      ((#b0000000000000000 #b1111111111111111) (#b0000000000000000))
      ((#b1111111111111111 #b1111111111111111) (#b1111111111111111))
      ((#b1010101010101010 #b0101010101010101) (#b0000000000000000))
      ((#b0011110011000011 #b0000111111110000) (#b1100110011001100))
      ((#b0001001000110100 #b1001100001110110) (#b0111010110111101)))))

(test-case "*** OR8-GATE ***"
  (check-table?
    (simulate or8-gate '(8) '(1))
    '(((#b00000000) (0))
      ((#b11111111) (1))
      ((#b00010000) (1))
      ((#b00000001) (1))
      ((#b00100110) (1)))))

(test-case "*** NOR16-GATE ***"
  (check-table?
    (simulate nor16-gate '(16) '(1))
    '(((#b0000000000000000) (1))
      ((#b0000001000000000) (0))
      ((#b1111111111111111) (0))
      ((#b1010101010101010) (0))
      ((#b0011110011000011) (0))
      ((#b0001001000110100) (0)))))
