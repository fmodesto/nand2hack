#lang racket/base

(require rackunit
         "simtest.rkt"
         "../src/simulator.rkt"
         "../src/arithmetic.rkt")

(test-case "*** INC ***"
  (check-table?
    (simulate inc '(1 1) '(1 1) 10)
    '(((0 0) (0 0))
      ((0 1) (1 0))
      ((1 0) (1 0))
      ((1 1) (0 1)))))

(test-case "*** INC-4 ***"
  (check-table?
    (simulate inc-4 '(4 1) '(4 1) 10)
    '(((0 0) (0 0))
      ((0 1) (1 0))
      ((1 1) (2 0))
      ((2 1) (3 0))
      ((3 1) (4 0))
      ((4 1) (5 0))
      ((5 1) (6 0))
      ((6 1) (7 0))
      ((7 0) (7 0))
      ((7 1) (8 0))
      ((8 1) (9 0))
      ((9 1) (10 0))
      ((10 1) (11 0))
      ((11 1) (12 0))
      ((12 1) (13 0))
      ((13 1) (14 0))
      ((14 1) (15 0))
      ((15 0) (15 0))
      ((15 1) (0 1)))))

(test-case "*** INC-16 ***"
  (check-table?
    (simulate inc-16 '(16 1) '(16))
    '(((0 0) (0))
      ((0 1) (1))
      ((348 0) (348))
      ((348 1) (349))
      ((14322 0) (14322))
      ((14322 1) (14323))
      ((65535 0) (65535))
      ((65535 1) (0)))))

(test-case "*** FULL-ADDER ***"
  (check-table?
    (simulate full-adder '(1 1 1) '(1 1 1) 10)
    '(((0 0 0) (0 0 1))
      ((0 0 1) (1 0 1))
      ((0 1 0) (1 0 1))
      ((0 1 1) (0 1 1))
      ((1 0 0) (1 0 1))
      ((1 0 1) (0 1 1))
      ((1 1 0) (0 1 0))
      ((1 1 1) (1 1 0)))))
