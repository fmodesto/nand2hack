#lang racket/base

(require rackunit
         "simtest.rkt"
         "../src/arithmetic.rkt")

(test-case "*** INC ***"
  (check-table?
    (simulate inc '(1 1) '(1 1))
    '(((0 0) (0 0))
      ((0 1) (1 0))
      ((1 0) (1 0))
      ((1 1) (0 1)))))

(test-case "*** INC4 ***"
  (check-table?
    (simulate inc4 '(4 1) '(4 1))
    '(((0 0) (0 0))
      ((0 1) (1 0))
      ((1 1) (2 0))
      ((2 1) (3 0))
      ((3 1) (4 0))
      ((4 1) (5 0))
      ((5 1) (6 0))
      ((6 1) (7 0))
      ((7 0) (7 0))
      ((7 1) (8 0))
      ((8 1) (9 0))
      ((9 1) (10 0))
      ((10 1) (11 0))
      ((11 1) (12 0))
      ((12 1) (13 0))
      ((13 1) (14 0))
      ((14 1) (15 0))
      ((15 0) (15 0))
      ((15 1) (0 1)))))

(test-case "*** INC16 ***"
  (check-table?
    (simulate inc16 '(16 1) '(16))
    '(((0 0) (0))
      ((0 1) (1))
      ((348 0) (348))
      ((348 1) (349))
      ((14322 0) (14322))
      ((14322 1) (14323))
      ((65535 0) (65535))
      ((65535 1) (0)))))

(test-case "*** FULL-ADDER ***"
  (check-table?
    (simulate full-adder '(1 1 1) '(1 1 1))
    '(((0 0 0) (0 0 1))
      ((0 0 1) (1 0 1))
      ((0 1 0) (1 0 1))
      ((0 1 1) (0 1 1))
      ((1 0 0) (1 0 1))
      ((1 0 1) (0 1 1))
      ((1 1 0) (0 1 0))
      ((1 1 1) (1 1 0)))))

(test-case "*** ADD4 ***"
  (check-table?
    (simulate add4 '(4 4 1) '(4 1 4))
    '(((0 0 0) (0 0 #b1111))
      ((0 0 1) (1 0 #b1111))
      ((1 1 0) (2 0 #b1110))
      ((5 7 1) (13 0 #b1010))
      ((10 5 0) (15 0 #b1111))
      ((8 8 0) (0 1 #b0111))
      ((15 15 0) (14 1 #b0000))
      ((15 15 1) (15 1 #b0000)))))

(test-case "*** ADD16 ***"
  (check-table?
    (simulate add16 '(16 16) '(16 16))
    '(((#b0000000000000000 #b0000000000000000) (#b0000000000000000 #b1111111111111111))
      ((#b0000000000000000 #b1111111111111111) (#b1111111111111111 #b1111111111111111))
      ((#b1111111111111111 #b1111111111111111) (#b1111111111111110 #b0000000000000000))
      ((#b1010101010101010 #b0101010101010101) (#b1111111111111111 #b1111111111111111))
      ((#b0011110011000011 #b0000111111110000) (#b0100110010110011 #b1111001100111111))
      ((#b0001001000110100 #b1001100001110110) (#b1010101010101010 #b1110111111001011)))))
